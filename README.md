# Unused Code Cleaner

[![Pub Version](https://img.shields.io/pub/v/unused_code_cleaner)](https://pub.dev/packages/unused_code_cleaner)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/Navid-Rahman/unused_code_cleaner/pulls)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

> **üéØ LATEST UPDATE - v1.8.1**  
> **PUB POINTS OPTIMIZATION & LOGGING SYSTEM OVERHAUL**  
> Complete logging system redesign with clean, professional output. Enhanced pub.dev scoring with modernized dependencies and improved compatibility.  
> **Now features clean structured sections with professional visual hierarchy**

A powerful and **SAFE** Dart CLI tool to identify and remove unused assets, functions, packages, and files from your Flutter and Dart projects, with comprehensive safety features and beautiful colored logging.

## üõ°Ô∏è ENHANCED SAFETY FEATURES

**LATEST IN v1.8.1 - PROFESSIONAL LOGGING & MODERNIZATION:**

1. **Clean Output System**: Professional structured sections with clean visual hierarchy
2. **Enhanced Analysis**: Advanced semantic analysis using Dart analyzer's Element system
3. **Flutter-Aware Detection**: Smart recognition of Flutter lifecycle methods and widgets
4. **Cross-File Dependencies**: Proper resolution of imports, exports, and library boundaries
5. **Enhanced Asset Detection**: Variable value tracking and fuzzy path matching
6. **Semantic Function Analysis**: Element-based tracking with framework method protection
7. **Advanced Package Analysis**: Sophisticated import tracking with conditional import handling
8. **Comprehensive Safety**: Multiple validation layers and intelligent exclusion patterns
9. **Modernized Dependencies**: Updated to latest analyzer and improved pub.dev compatibility

**ALWAYS FOLLOW THESE SAFETY STEPS:**

1. **Commit your code to version control first**
2. **Always run with `--dry-run` first**
3. **Review the list carefully before proceeding**
4. **Keep automatic backups enabled (default)**

```bash
# SAFE WORKFLOW - Always start here:
dart run unused_code_cleaner --dry-run --all --verbose

# Review output carefully, then if safe:
dart run unused_code_cleaner --all --verbose
```

üöÄ **Features**

- üñºÔ∏è **Asset Analysis**: Safely detects unused images, fonts, JSON files, and other assets with semantic AST-based detection
- ‚ö° **Function Analysis**: Identifies unused functions and methods using enhanced semantic analysis with Flutter awareness
- üì¶ **Package Analysis**: Finds unused dependencies with sophisticated import tracking and element resolution
- üìÑ **File Analysis**: Locates unused Dart files not imported anywhere
- ÔøΩ **Comprehensive Analysis Summary**: Complete overview of all 4 core functionalities with health assessment
- üè• **Project Health Scoring**: Dynamic health scoring (0-100%) with weighted issue severity assessment
- üí∞ **Actionable Improvement Recommendations**: Clear space savings calculations and optimization suggestions
- ‚è±Ô∏è **Performance Metrics**: Analysis time tracking with processing speed and throughput statistics
- ÔøΩüõ°Ô∏è **Safety Features**: Dry-run mode, automatic backups, and multiple confirmations
- üé® **Colored Logging**: Clear, emoji-enhanced, colored console output
- üîß **Interactive Mode**: Prompts for confirmation before removing items
- üìä **Detailed Reports**: Comprehensive analysis reports with file sizes
- üõ† **Customizable**: Supports exclude patterns and configuration files
- ‚úÖ **Cross-Platform**: Works on all platforms with enhanced path handling
- üîç **AST-Based Analysis**: Advanced code analysis using Dart's Abstract Syntax Tree
- üöÄ **Enhanced Semantic Analysis**: Deep semantic analysis with element tracking (enabled by default)

üì¶ **Installation**

For use as a command-line tool, activate it globally:

```bash
dart pub global activate unused_code_cleaner
```

Or add it to your `dev_dependencies` in `pubspec.yaml`:

```yaml
dev_dependencies:
  unused_code_cleaner: ^1.8.1
```

## üöÄ Advanced Analysis Features

**Semantic Analysis** provides significantly more accurate detection by using Dart's semantic model:

```bash
# Advanced semantic analysis is enabled by default
dart run unused_code_cleaner --dry-run --all --verbose
```

**Advanced Features:**

- üß† **Element-Based Tracking**: Uses semantic elements instead of name matching
- üîç **Cross-File Analysis**: Tracks dependencies across compilation units
- üéØ **Flutter-Aware**: Recognizes Flutter widget lifecycle methods and patterns
- üìù **Variable Resolution**: Tracks variable assignments and usages semantically
- üîó **Import Chain Analysis**: Handles conditional imports and export chains
- ‚ö° **Accurate Asset Detection**: Semantic analysis of Image.asset(), AssetImage(), etc.

**Trade-offs:**

- ‚úÖ **More Accurate**: Significantly fewer false positives
- ‚úÖ **Context-Aware**: Understands framework patterns and generated code
- ‚ö†Ô∏è **Slower**: Takes longer due to comprehensive semantic analysis
- üí° **Recommended**: For final cleanup or when accuracy is critical

## üõ°Ô∏è Safety Features

**Core Safety Features:**

- üõ°Ô∏è **Dry-Run Mode**: Preview all changes before execution with `--dry-run`
- üì¶ **Automatic Backups**: Creates timestamped backups before deletion (disable with `--no-backup`)
- üîí **Protected Assets**: Never deletes assets declared in `pubspec.yaml`
- ‚ö†Ô∏è **Mass Deletion Warning**: Alerts when >10 items marked for deletion
- üîç **Enhanced Detection**: Comprehensive asset reference detection (constants, package: URLs, variables)
- üìã **Detailed Logging**: Shows exactly why each item is marked as unused
- ‚úã **Multiple Confirmations**: Requires explicit confirmation for file deletion
- üõ†Ô∏è **Pattern Exclusions**: Supports glob patterns to protect critical files

**Critical Safety Protections:**

- ‚úÖ **Self-Protection**: Cannot analyze the unused_code_cleaner package itself
- ‚úÖ **System Directory Protection**: Prevents analysis of critical system directories
- ‚úÖ **pubspec.yaml Assets**: Automatically protects all declared assets
- ‚úÖ **Generated Files**: Excludes .g.dart, .freezed.dart, build/, .dart_tool/
- ‚úÖ **Path Normalization**: Robust cross-platform path handling
- ‚úÖ **Reference Detection**: Finds assets in constants, variables, package: URLs

**Always backup your project before running cleanup operations!**

## üîß Usage

### Safe Workflow (RECOMMENDED)

```bash
# 1. ALWAYS start with dry-run to preview changes
dart run unused_code_cleaner --dry-run --all --verbose

# 2. Advanced semantic analysis is enabled by default
dart run unused_code_cleaner --dry-run --all --verbose

# 3. Review the output carefully - check for any assets you need

# 4. If the results look correct, run without dry-run
dart run unused_code_cleaner --all --verbose

# 5. Backups are automatically created in unused_code_cleaner_backup_* folder
```

### Command Line

Analyze your project for unused items:

```bash
dart run unused_code_cleaner
```

Remove all unused items (interactive mode):

```bash
dart run unused_code_cleaner --all
```

**Analysis Examples:**

```bash
# Advanced semantic analysis with dry-run
dart run unused_code_cleaner --functions --dry-run

# Asset analysis with variable tracking
dart run unused_code_cleaner --assets --verbose --dry-run

# Package analysis with dependency chain tracking
dart run unused_code_cleaner --packages --dry-run
```

Remove specific types of unused items:

```bash
dart run unused_code_cleaner --assets --packages
```

Enable verbose logging:

```bash
dart run unused_code_cleaner --verbose
```

Exclude specific patterns:

```bash
dart run unused_code_cleaner --exclude "**/*.g.dart" --exclude "**/*.freezed.dart"
```

Specify a custom project path:

```bash
dart run unused_code_cleaner --path=/path/to/your/project
```

### Programmatic Usage

Use the package in your Dart code:

````dart
```dart
import 'package:unused_code_cleaner/unused_code_cleaner.dart';

void main() async {
  final cleaner = UnusedCodeCleaner();
  final options = CleanupOptions(
    removeUnusedAssets: true,
    removeUnusedPackages: true,
    verbose: true,
    interactive: true,
    excludePatterns: ['**/*.g.dart', '**/*.freezed.dart'],
  );

  try {
    final result = await cleaner.analyze('.', options);
    print('Found ${result.totalUnusedItems} unused items in ${result.analysisTime.inMilliseconds}ms');
  } catch (e) {
    print('Error: $e');
  }
}
````

## üõ† Advanced Options

| Option          | Description                                                              |
| --------------- | ------------------------------------------------------------------------ |
| `--all`         | Enables removal of all unused items (assets, functions, packages, files) |
| `--assets`      | Removes unused assets                                                    |
| `--functions`   | Removes unused functions                                                 |
| `--packages`    | Removes unused packages from pubspec.yaml                                |
| `--files`       | Removes unused Dart files                                                |
| `--verbose`     | Enables detailed logging                                                 |
| `--interactive` | Prompts for confirmation before removing items (default: true)           |
| `--exclude`     | Specifies patterns to exclude (e.g., \*_/_.g.dart)                       |
| `--path`        | Specifies the project directory to analyze (default: current directory)  |
| `--dry-run`     | Preview changes without executing them (RECOMMENDED)                     |
| `--no-backup`   | Skip creating backups before deletion                                    |

## Example Output

```
üîç UNUSED CODE CLEANER - ANALYSIS STARTED
‚ÑπÔ∏è [12:34:56] Found 42 Dart files to analyze
‚úÖ [12:34:56] Project structure validated

üì¶ ANALYZING ASSETS
‚ÑπÔ∏è [12:34:57] Found 3 unused assets

‚ö° ANALYZING FUNCTIONS
‚ÑπÔ∏è [12:34:57] Found 2 unused functions

üì¶ ANALYZING PACKAGES
‚ÑπÔ∏è [12:34:57] Found 1 unused package

üìÑ ANALYZING FILES
‚ÑπÔ∏è [12:34:57] Found 1 unused file

üìä ANALYSIS RESULTS
‚ÑπÔ∏è [12:34:57] Analysis completed in 123ms
‚ÑπÔ∏è [12:34:57] Total files scanned: 42
‚ÑπÔ∏è [12:34:57] Total unused items found: 7

Unused Assets (3 items)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Name              ‚îÇ Path                  ‚îÇ Size ‚îÇ Description         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üñºÔ∏è unused.png     ‚îÇ assets/unused.png     ‚îÇ 1.2MB‚îÇ Unused asset file   ‚îÇ
‚îÇ üñºÔ∏è old.json       ‚îÇ assets/data/old.json  ‚îÇ 0.5KB‚îÇ Unused asset file   ‚îÇ
‚îÇ üñºÔ∏è unused.svg     ‚îÇ assets/unused.svg     ‚îÇ 0.8MB‚îÇ Unused asset file   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ùì Do you want to remove these assets? (y/N)
```

## üìä Accuracy Testing

The package was tested against real-world Flutter projects to ensure reliability:

| Project       | Total Files | Total Assets | Known Unused | Language Files         |
| ------------- | ----------- | ------------ | ------------ | ---------------------- |
| üõí E-commerce | 1,500       | 245          | 32           | 3 (en, fr, es)         |
| üì± Social App | 3,200       | 412          | 67           | 5 (en, es, pt, ru, zh) |
| üè¢ Enterprise | 10,000      | 1,123        | 189          | 8 (multi-region)       |

Tests confirmed accurate detection of unused assets, functions, packages, and files, with robust handling of edge cases like generated files and special functions.

## üéØ Roadmap

### üöÄ Completed Features:

- ‚úÖ Support for automatic function removal using AST manipulation
- ‚úÖ Integration with CI/CD pipelines for automated cleanup
- ‚úÖ Comprehensive documentation and examples
- ‚úÖ Pure Dart CLI tool (no Flutter SDK dependency)
- ‚úÖ Pattern-based exclusion system
- ‚úÖ Interactive and non-interactive modes
- ‚úÖ Enhanced semantic analysis with element-based tracking
- ‚úÖ Project health scoring and comprehensive result overview
- ‚úÖ Professional logging system with clean output
- ‚úÖ Multi-platform support and modern dependency management

### üìã Upcoming Features:

- ‚ùå Configuration file support (`unused_code_cleaner.yaml`)
- ‚ùå Support for additional file types (e.g., TypeScript, Kotlin)
- ‚ùå Generate detailed HTML/PDF reports
- ‚ùå VS Code extension for real-time analysis
- ‚ùå Integration with popular CI/CD platforms (GitHub Actions, GitLab CI)
- ‚ùå Batch processing for multiple projects

## ü§ù Contributing

We welcome contributions! Please submit issues, feature requests, or pull requests on GitHub. Follow these steps:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/your-feature`)
3. Commit your changes (`git commit -m "Add your feature"`)
4. Push to the branch (`git push origin feature/your-feature`)
5. Open a pull request

## üì¨ Contact

üì© Need help? Reach out at [navidrahman92@gmail.com] or open an issue on GitHub.

## üìú License

üìÑ This project is licensed under the MIT License.
